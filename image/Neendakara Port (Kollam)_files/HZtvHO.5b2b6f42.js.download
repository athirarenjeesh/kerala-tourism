(this.$WP=this.$WP||[]).push(["HZtvHO",(e,t)=>{"use strict";var a,r,i,n,o,l,s,c,d,p,u,v,m,T,g,E,S,C,b,f,I,h,y,k,O,R,M,_,A,L,j,P,x,D,V,w,N,F,B,U;function q(...e){for(var t=[],a=function(a){var r=e[a];if(r){var i=typeof r;"string"===i||"number"===i?t.push(r):Array.isArray(r)?t.push(q(...r)):"object"===i&&Object.keys(r).filter((e=>r[e])).forEach((e=>t.push(e)))}},r=0;r<e.length;r++)a(r);return t.join(" ")}var W={marginLeft1:"dBhKd",marginRight1:"cCzei",marginTop1:"cbSHg",marginBottom1:"eVjae",marginLeft2:"bGusc",marginRight2:"fksET",marginTop2:"bLFSo",marginBottom2:"cspKb",marginLeft3:"edkls",marginRight3:"eQkGL",marginTop3:"RiTin",marginBottom3:"MLeMj",marginLeft4:"bjDAD",marginRight4:"eyRbR",marginTop4:"faMvo",marginBottom4:"fbrwK",marginLeft5:"cxGsy",marginRight5:"cOCVE",marginTop5:"fBRVc",marginBottom5:"eXrsm",marginLeft6:"daVLy",marginRight6:"cSWgH",marginTop6:"eufYP",marginBottom6:"cDHZq",marginLeft7:"eRgrC",marginRight7:"dahXR",marginTop7:"FMwqw",marginBottom7:"eXqEW",marginLeft8:"civSC",marginRight8:"frWqN",marginTop8:"cAQlX",marginBottom8:"chJfh",marginLeft9:"frDlr",marginRight9:"bTXxI",marginTop9:"dthya",marginBottom9:"bwqlk",marginLeft10:"OOOCl",marginRight10:"LWpUV",marginTop10:"fyHai",marginBottom10:"bSjHJ"};function G(e){for(var t={},a=1;a<=10;a++)t[`spacing-${String(a).padStart(2,"0")}`]=W[`margin${e}${a}`];return t}function X({margin:e,marginX:t,marginY:a,marginTop:r,marginBottom:i,marginLeft:n,marginRight:o}){var l=r||a||e,s=i||a||e,c=n||t||e,d=o||t||e;return q(l&&L.top[l],s&&L.bottom[s],c&&L.left[c],d&&L.right[d])}var H=e=>r.createElement("svg",(({color:e="inherit",size:t="inherit",...a},i=!1)=>{var n="inherit"!==t?`${t}px`:"1em",{isRtl:o}=r.useContext(u).locale;return{viewBox:"0 0 24 24",width:n,height:n,className:q("bDFSd d Vb",X(a),"inherit"===e&&"ymbyq","primaryIcon"===e&&"XHxQa","secondaryIcon"===e&&"dZxVn","onDarkIcon"===e&&"dRJTS","primarySelectedIcon"===e&&"CYIDi","activeMapPinIcon"===e&&"cFxQv","bubbleIcon"===e&&"dWmWj","starIconFilled"===e&&"sFBYx","starIconEmpty"===e&&"Stndk","dragIcon"===e&&"eSOtO","dangerIcon"===e&&"frovT","verifiedCheckMarkIcon"===e&&"coqqe","accentPurpleText"===e&&"cYGZX","onLightText"===e&&"bVlNw","plusIcon"===e&&"ehGNF","textDisabled"===e&&"dasoo",!i&&o&&"eeDcX")}})(e),r.createElement("path",{d:"M12.001 20.729s-6.741-5.85-8.485-8.003c-2.055-2.541-2.018-5.837.089-7.836a5.928 5.928 0 014.104-1.618c1.548 0 3.005.575 4.104 1.618l.174.165.162-.155a5.93 5.93 0 014.104-1.618c1.548 0 3.005.574 4.104 1.618 2.158 2.049 2.192 5.273.084 7.841-1.755 2.139-8.44 7.988-8.44 7.988zM7.709 5.271a3.935 3.935 0 00-2.727 1.068c-1.578 1.498-1.06 3.708.088 5.128 1.306 1.613 5.333 5.204 6.925 6.605 1.583-1.404 5.58-4.993 6.899-6.601 1.195-1.455 1.685-3.603.085-5.122-.726-.689-1.694-1.069-2.728-1.069s-2.001.38-2.728 1.069l-1.539 1.462-1.551-1.473a3.925 3.925 0 00-2.724-1.067z"})),Q=(e,t)=>{var a,r,i;if(!t)return e;var n=(null==(a=e.paginatedTrips)?void 0:a.trips)||[],o=(null==(r=t.paginatedTrips)?void 0:r.trips)||[];return{paginatedTrips:e.paginatedTrips?{trips:[...n,...o],hasMore:!(null==(i=t.paginatedTrips)||!i.hasMore),__typename:e.paginatedTrips.__typename}:t.paginatedTrips,savedTrips:e.savedTrips}},z=e=>{var t;return{__typename:e.__typename,id:e.id||0,title:e.title||void 0,status:e.status||void 0,photoId:e.photoId||void 0,photo:e.photo||{},route:{url:e.route&&e.route.url||void 0},actionPermissions:{canAddItem:!(null==(t=e.actionPermissions)||!t.canAddItem)}}},$=e=>{var t,r,i,n,o,l=(t,a)=>{if(!t||!a)return"invalidateAndRefetch";var{originalObject:r}=e;return r&&a===r.type&&t===String(r.id)||a===e.type&&t===String(e.id)?"invalidateAndRefetch":"validate"},{userId:c}=a.useContext(v),d={offset:0,limit:10,userId:c||"",reference:s(e),loadSavedTrips:!0},[p,u]=M({query:A,variables:d,combineData:Q,showFetchingAfterFirstQuery:!0,invalidationPredicates:{createTrip:()=>"invalidateAndRefetch",cloneTrip:()=>"invalidateAndRefetch",tripsDelete:()=>"invalidateAndRefetch",addItemToTrip:({variables:{referenceId:e,referenceType:t}})=>l(e,t),moveTripItem:({variables:{reference:e}})=>l(null==e?void 0:e.id,null==e?void 0:e.type),tripsRemoveItem:({variables:{reference:e}})=>l(null==e?void 0:e.id,null==e?void 0:e.type),tripsRemoveReference:({variables:{reference:e}})=>l(null==e?void 0:e.id,null==e?void 0:e.type)}}),m=(null==(t=p.data)||null==(r=t.paginatedTrips)?void 0:r.trips)||[],T=m.slice().filter(Boolean).map(z),g=!(null==(i=p.data)||null==(n=i.paginatedTrips)||!n.hasMore),E=(null==(o=p.data)?void 0:o.savedTrips)||[],S=new Set(E.map((e=>null==e?void 0:e.id)).filter(Boolean)),C=g?()=>u({offset:(null==m?void 0:m.length)||0,loadSavedTrips:!1}):()=>Promise.resolve();return{fetching:p.fetching,error:!!p.error,data:{tripList:T,saveSet:S,canMakePublicTrip:!0},hasMore:g,loadMore:C}},Y="cYchV Fn f u j",K="esVrA",J=({saveObject:e,overlayState:t,validateTripName:r,lastSavedItem:n,trackingContext:o,trackingSource:l,...s})=>{var d,[p,u]=a.useState(!0),{fetching:v,error:m,data:T,hasMore:g,loadMore:E}=P(e);v?d=a.createElement(h,{size:"large"}):m&&(d=a.createElement(R,{refetch:E})),a.useEffect((()=>{v||u(!1)}),[]);var[S]=i({source:l||"trips",trackingContext:o,pageAsContext:!0,withSaveSession:!0}),C=()=>{s.onClose(),u(!0)},b=x[t](e.type),y=a.createElement(I,{icon:j,displayType:"LEFT_ALIGN_GRAY"},b);return a.createElement(O,{element:"bundleSave"===e.type?"copyTripModal":"saveTripModal"},a.createElement(f,{header:y,closeIconColor:"BLACK",bodyProps:{isFullBleed:!0},onClose:C},d&&p?a.createElement("div",{className:Y},d):(()=>{var i=n?c(n):void 0,p=()=>a.createElement("div",{className:K},a.createElement(D,{gate:()=>Promise.resolve(),object:e,onMount:()=>{v||m||S({elementClick:{element:"createTrip"}})},onAddedToCreatedTrip:e=>{s.statCallback("ADD","NEW",e,!0,!0),C()},onError:s.onError,canMakePublicTrip:T.canMakePublicTrip,validateTripName:r,trackingContext:o,trackingSource:l}));switch(t){case"DEFAULT":return 0===T.tripList.length?p():a.createElement(w,{tripList:T.tripList,savedSet:T.saveSet,tripListBottom:d,onPaginate:E,hasMore:g,saveObject:e,onMount:()=>{s.preventInteractionInMountedComponents||S({elementClick:{element:"stat"}})},onCreateTrip:()=>{s.onCreateTripClicked&&s.onCreateTripClicked()},tripAction:"SAVE",onRemovedFromTrip:(e,t,a)=>{s.statCallback("REMOVE","EXISTING",e,t,a),C()},onSavedToTrip:(e,t,a)=>{s.statCallback("ADD","EXISTING",e,t,a),C()},onError:s.onError,trackingContext:o,trackingSource:l});case"CREATE":return p();case"SELECT":return i?a.createElement(w,{tripList:T.tripList,savedSet:T.saveSet,tripListBottom:d,onPaginate:E,hasMore:g,saveObject:i,onMount:()=>{S({elementClick:{element:"stat"}})},onCreateTrip:()=>{s.onSelectCreateTripClicked&&s.onSelectCreateTripClicked()},tripAction:"MOVE",onMovedToTrip:(e,t,a)=>{s.statCallback("MOVE","EXISTING",e,t,a),C()},onRemovedFromTrip:(e,t,a)=>{s.statCallback("REMOVE","EXISTING",e,t,a),C()},onError:s.onError,trackingContext:o,trackingSource:l}):"";case"SELECT_CREATE":return n?a.createElement("div",{className:K},a.createElement(V,{gate:()=>Promise.resolve(),item:n,onMovedToCreatedTrip:e=>{s.statCallback("MOVE","NEW",e,!0,!0),C()},canMakePublicTrip:T.canMakePublicTrip})):p();default:return""}})()))},Z=e=>{},ee=(e,t)=>{switch(t.type){case"setOverlayState":return{...e,overlayState:t.state};case"afterSave":return{...e,overlayState:"DEFAULT",preventInteractionInMountedComponents:!0};default:throw new Error}},te=({allowPopStatModal:e,logInteraction:t,puid:r,object:i,active:n,preventInteractionPropagation:l,trackingContext:s,trackingSource:c,resaveTrip:d,saveObject:u,saveStatus:m,updateLastTripId:T,onClose:g,initialOverlayState:E,...b})=>{var f,{userId:I}=a.useContext(v),{launchViewTripToast:h,launchRemoveFromTripToast:y,launchErrorTripToast:k}=p(),{getTripErrorMessage:O}=S(),R=C("SAVE_TO_TRIP_INTENT"),M=C("SAVE_TO_TRIP"),_=C({type:"CREATE_TRIP",payload:{user_id:I||""}}),A=a.useContext(o),[L,j]=a.useReducer(ee,{overlayState:E||"DEFAULT",preventInteractionInMountedComponents:!1}),P=a.useRef(!0);a.useEffect((()=>()=>{P.current=!1}),[]);var{onComplete:x}=b,D=a.useCallback((e=>{x&&x(e),A.resetSession()}),[x,A]),V=a.useCallback(((e,a)=>{e&&!a?(h(e,"SAVED",(()=>{t({elementClick:{element:"saved_viewTrip"}})})),D(!0)):a&&(k(a),D(!1)),P.current&&j({type:"setOverlayState",state:"DEFAULT"}),t({elementClick:{element:"unsave_undo"}})}),[h,D,k,t]),w=a.useCallback((e=>{y(e,u,V)}),[y,V,u]),F=a.useCallback((e=>{k(e)}),[k]),[B,U]=a.useState(!1),q=a.useCallback((()=>{U(!0),A.resetSession()}),[A]),W=a.useCallback(((e,a)=>{"CREATED"===a&&(M(),_()),P.current&&j({type:"afterSave"}),h(e,a,(()=>{t({elementClick:{element:"saved_viewTrip"}})})),T(e.id),D(!0)}),[M,h,D,T,_,t]);return!B&&a.createElement("div",{className:"stat_wrapper",onClick:e=>{e.stopPropagation(),e.preventDefault(),!l&&I&&t({elementClick:{element:"item_save",tripId:null==d?void 0:d.id}}),n||R()}},a.createElement(N,{saveObject:u,overlayState:L.overlayState,lastSavedItem:null==(f=m.result)?void 0:f.tripItem,trackingContext:s,trackingSource:c,onCreateTripClicked:()=>{P.current&&j({type:"setOverlayState",state:"CREATE"})},onSelectCreateTripClicked:()=>{P.current&&j({type:"setOverlayState",state:"SELECT_CREATE"})},onClose:q,onError:F,preventInteractionInMountedComponents:L.preventInteractionInMountedComponents,statCallback:(e,t,a,r,i)=>{"REMOVE"===e?(w(a),D(i)):"NEW"===t?W(a,"CREATED"):r&&W(a,"SAVED")},validateTripName:e=>{if("bundleSave"===u.type&&e.trim().toLowerCase()===i.title.trim().toLowerCase())return O("COPY_TRIP",{type:"INVALID_VALUE",field:"TITLE"})}}))},ae=e=>a.createElement(n,null,a.createElement(b,null,a.createElement(te,e))),re=["Profile","HomeFeed","Trips","Home"],ie=e=>{var t=a.useMemo((()=>e.saveObject||c(e.object,!0)),[e.saveObject,e.object]),{resaveTrip:r,onComplete:n,allowPopStatModal:s}=e,{isNativeWebview:d,tripId:u,...v}=e,{launchAutoSavedToTripToast:S,launchErrorTripToast:C}=p(),[b]=a.useContext(m),{page:f}=b,I=a.useMemo((()=>({source:e.trackingSource||"trips",saveObject:t,trackingContext:e.trackingContext,withSaveSession:!0,pageAsContext:!0})),[e.trackingContext,e.trackingSource,t]),[h,y]=i(I),k=a.useContext(o),[O,R,M]=T(u,t,e.active),_=null==t?void 0:t.id,A=null==t?void 0:t.type,L=a.useCallback((e=>{C(e)}),[C]),j=a.useCallback((()=>{h({elementClick:{element:"ITEM_SAVE_LOGIN",context:f&&l(f)||void 0,puid:y,saveType:A,detailId:_?`${_}`:"",tripId:null==r?void 0:r.id,sessionType:"SAVE",sessionUuid:k.sessionUuid,sessionOrder:k.sessionOrder}})}),[h,f,y,r,_,A,k.sessionOrder,k.sessionUuid]),P=a.useCallback((()=>{h({modalSuccess:{element:"ITEM_SAVE_LOGIN",context:f&&l(f)||void 0,puid:y,saveType:A,detailId:_?`${_}`:"",tripId:null==r?void 0:r.id,sessionType:"SAVE",sessionUuid:k.sessionUuid,sessionOrder:k.sessionOrder}})}),[h,f,y,r,_,A,k.sessionOrder,k.sessionUuid]),x=a.useMemo((()=>({pid:f&&re.includes(b.page)?40439:39766,flow:d?"NATIVE_LOGIN":"SAVES_COMBINED",onLogin:j,onSuccess:P,isFullWidthMobile:!0})),[j,P,f,b.page,d]),D=g(x),V=a.useRef(!1),{open:w}=E((()=>t?a.createElement(F,Object.assign({},v,{logInteraction:h,puid:y,saveObject:t,saveStatus:O,updateLastTripId:M})):null)),{open:N}=E((()=>t?a.createElement(F,Object.assign({},v,{initialOverlayState:"SELECT",logInteraction:h,puid:y,saveObject:t,saveStatus:O,updateLastTripId:M})):null)),B=!!s&&(b.params.popStat||!1);return a.useEffect((()=>{B&&!V.current&&(V.current=!0,h({elementClick:{element:"autoPopStat"}}),D().then(w))}),[h,D,w,B]),a.useCallback((()=>{D().then((()=>R())).then((([e,t])=>{null!==e||null!==t?t?L({query:"ADD_ITEM_TO_TRIP",tripsError:t}):e&&(S(e,(()=>{N(),h({elementClick:{element:"quickSave_change"}})})),h({modalSuccess:{element:"quickSave",tripId:null==r?void 0:r.id,context:f&&l(f)||void 0,saveType:A,detailId:_?`${_}`:""}}),n&&n(!0)):w()}))}),[w,N,S,h,D,n,L,R,f,r,_,A])},ne=({children:e,...t})=>{var r=a.useMemo((()=>t.saveObject||c(t.object,!0)),[t.saveObject,t.object]),i=B(t);return r?a.createElement(n,null,e(i)):null},oe=({queryObject:e,children:t,...r})=>{var i,n,o,l,s,c,d,p,u,[m,T]=a.useState(null!=(i=r.object)&&null!=(n=i.object)&&n.socialStatistics?!(null==(o=r.object)||null==(l=o.object)||null==(s=l.socialStatistics)||!s.isSaved):!(null==(c=r.object)||null==(d=c.socialStatistics)||!d.isSaved)),g=(t,a)=>{if(!t||!a)return"invalidateAndRefetch";var{originalObject:r}=e;return r&&a===r.type&&t===String(r.id)||a===e.type&&t===String(e.id)?"invalidateAndRefetch":"validate"},{userId:E}=a.useContext(v);u=E?null!=(p=r.object)&&p.socialStatistics?"afterInvalidation":"immediately":"never";var[{fetching:S,data:C,error:b}]=_({query:e.query,variables:e.variables,executeWhen:u},{addItemToTrip:({variables:{referenceId:e,referenceType:t}})=>g(e,t),tripsRemoveItem:({variables:{reference:e}})=>g(null==e?void 0:e.id,null==e?void 0:e.type),tripsRemoveReference:({variables:{reference:e}})=>g(e.id,null==e?void 0:e.type)});return a.useEffect((()=>{if(!S&&!b){var t=C&&C.savesObjects&&C.savesObjects[0];if(t){var{id:a,socialStatistics:r={}}=t,i=(a===e.id||String(a)===e.id)&&!!r.isSaved;i!==m&&T(i)}}}),[S,C,b]),a.createElement(U,Object.assign({active:m},r),(e=>t(e,m,S)))},le=e=>{var t=e.saveObject||c(e.object,!0);if(!t)return console.error("An invalid saves object was passed to QueriedTripFlowSelector"),null;var r=d(t);return r?a.createElement(oe,Object.assign({},e,{queryObject:r})):(console.error("Unsupported saves object was passed to QueriedTripFlowSelector"),null)};return[()=>{L={top:G("Top"),bottom:G("Bottom"),left:G("Left"),right:G("Right")},j=H,P=$,x=Object.freeze({DEFAULT:e=>"bundleSave"!==e?a.createElement(y,{id:"stat_modal_save_to_trip_v2"}):a.createElement(y,{id:"save_all_items_modal_header"}),CREATE:()=>a.createElement(y,{id:"stat_modal_create_a_trip_v2"}),SELECT:()=>a.createElement(y,{id:"select_trip_header"}),SELECT_CREATE:()=>a.createElement(y,{id:"stat_modal_create_a_trip_v2"})}),D=k.component.onUsage((()=>t("neHaXV")),"CreateTripWithAddItemModal",a.createElement("div",{className:Y},a.createElement(h,{size:"large"}))),V=k.component.onUsage((()=>t("neHaXV")),"CreateTripWithMoveItemModal",a.createElement("div",{className:Y},a.createElement(h,{size:"large"}))),w=k.component.onUsage((()=>t("pBQaod")),"SaveToTripContent",a.createElement("div",{className:Y},a.createElement(h,{size:"large"}))),N=J,te.defaultProps={preventInteractionPropagation:!1,onComplete:void 0,trackingContext:void 0,allowPopStatModal:!1},F=ae,B=ie,U=ne,le.defaultProps={object:null,trackingContext:void 0,allowPopStatModal:!1},e({QueriedTripFlowSelector:le,TripFlowSelector:U,setSTATDisabledForTesting:Z})},[e=>(a=e,r=e.default),e=>(i=e.useTripInteraction,n=e.SaveSessionProvider,o=e.SaveSessionTrackingContext,l=e.getInteractionsContext),e=>(s=e.toReference,c=e.toSavesObject,d=e.objectStatisticQuery),e=>p=e.default,e=>(u=e.Environment,v=e.Visitor,m=e.Route),e=>T=e.useAutosave,e=>g=e.useSocialLoginGate,e=>E=e.useVDOMPortal,e=>S=e.useLocalizeTripError,e=>C=e.usePixelCallback,e=>b=e.ToastProvider,e=>f=e.default,e=>I=e.TitleBar,e=>h=e.LoadingSpinner,e=>y=e.default,e=>k=e,e=>O=e.TripsImpression,e=>R=e.default,e=>(M=e.usePaginatedQuery,_=e.useInvalidatableQuery),e=>A=e.TripDetailStatQuery]]},["cDcdfi","U-DhDC","eFKnUp","PiTJFd","2R4xv2","fTyhRT","JFHNGL","vq6MSq","9I0t-6","jb_4W2","Q7TAd7","O8LbtK","6nM-E7","V08PS7","0DsHEV","pLbCP4","c_rvp5","LFeTN6","OnmvvE","RXx5aI"]]);
