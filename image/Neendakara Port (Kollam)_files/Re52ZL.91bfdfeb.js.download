(this.$WP=this.$WP||[]).push(["Re52ZL",(e,t)=>{"use strict";var a,n,i,l,r,o,s,u,d,c,m,p,v,C,g,k,h,S,b,_,f,E,y,A,N,T,I,D,P,F,O,M,L,w,R,B,V,x,U,H,K,G,q,z,W,Y,$,j,J,X,Z,Q,ee,te,ae,ne,ie,le,re,oe,se,ue,de,ce,me,pe,ve,Ce=e=>{var t,{userAgentCategory:a}=n(k),{preferences:{currency:r}}=n(h),[,o]=le(de),[s,u]=i({}),[d,c]=i(null),[m,p]=i(!0);l((()=>c(window.location.origin)),[]);var v=(e=>{switch(e){case"TABLET":return"TabletWeb";case"MOBILE":return"MobileWeb";default:return"Desktop"}})(a);return l((()=>{d&&o({request:{clientType:v,currencyCode:r,origin:d,mode:e}}).then((e=>{var t;u(null==(t=e.data)?void 0:t.subscriptionCheckout),p(!1)})).catch()}),[r,o,d,v,e]),{billingAccountId:null==s?void 0:s.billingAccountId,loadingCheckoutSession:m,cdeSession:null==s?void 0:s.cdeSession,paymentCountries:null==s||null==(t=s.countryStateData)?void 0:t.availableCountries.filter(Boolean).map((e=>function(e){var{countryName:t,isoCode:a,statesData:n}=e;return{alphaCode:a||"",name:t||"",countryCode:void 0,geoId:void 0,states:n?n.filter(Boolean).map((e=>function(e){var{isoCode:t,stateName:a}=e;return{code:t||"",name:a||""}}(e))).sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()))):[]}}(e)))}},ge=({isModal:e})=>{var t=te(),n=()=>a.createElement(ae,{variant:"primary",onClick:()=>t(K("/OptimusAccountManager"))},a.createElement(j,{id:"plus_confirmation_manage_membership_cta"}));return e?a.createElement(a.Fragment,null,a.createElement(oe,{variant:"title-01",marginY:"spacing-05"},a.createElement(J,{id:"plus_already_member"})),a.createElement(n,null)):a.createElement(re,{title:a.createElement(J,{id:"plus_already_member"})},a.createElement(D,{paddingY:"spacing-03",paddingX:["spacing-04","spacing-04","spacing-00"]},a.createElement(n,null)))},ke=({isModal:e})=>e?a.createElement(D,{className:"dHjOJ _Q t s l _U",display:"flex",justifyContent:"center",alignItems:"center"},a.createElement(se,{size:"large",variant:"primary"})):a.createElement(P,null),he=e=>{var[t,n]=i(null),l=X(),r=a.useCallback((e=>l.formatDate("date_short_year_long",e)),[l]),{discount:o,trialPeriod:s}=e||{},u=null;if(x.includes(null==o?void 0:o.discountCode)?u="Hertz":(null==o?void 0:o.discountCode)===U?u="Rent the Runway":(null==o?void 0:o.discountCode)===H&&(u="Audible"),u&&!t){var d=new Date((new Date).setFullYear((new Date).getFullYear()+1));n(a.createElement(J,{id:"optimus_payment_alert_auto_renewal",args:{price:null!=o&&o.originalPrice?l.formatCurrency(o.originalPrice):"$99",0:"cDWzL b",date:r(d)}}))}var c=null==s?void 0:s.endDate;return c&&!t&&n(a.createElement(j,{id:"plus_trial_payment_alert_v3",args:{endDate:r(c)}})),t},Se="STANDALONE",be=({mode:e,modalVariant:t,onPaymentError:k,onPurchaseSuccess:h,hotelId:A,freeTrialSubscription:P=!1,children:F})=>{var O,M,q,J,[{page:ae,params:le},{uid:re}]=n(S),{userId:oe,sessionId:se}=n(b),{funnelKey:ue}=n(N),de=te(),Ce=Q(),ge=ee(),ke=ie(),{localize:he}=Z(),be=X(),_e=a.useCallback((e=>be.formatDate("date_short_year_long",e)),[be]),fe=u("plus_discount_codes"),{subscriptionPrice:Ee,fetching:ye,error:Ae}=W(P?"TRIAL_CHECKOUT":"CHECKOUT"),{fullSubscription:Ne,discount:Te,trialPeriod:Ie}=Ee||{},{firstCharge:De}=Ne||{},[{data:Pe}]=Y(),Fe=$(),Oe=a.useMemo((()=>v()),[]),Me=ve(Ee),[Le,we]=i(!1),[Re,Be]=i(!1),[Ve,xe]=i(0),Ue=r(null),[,He]=i(!1),[Ke,Ge]=i(""),qe=d();l((()=>{Le||qe((e=>{var t=e||null;t&&!Le&&Ge(t)}),null,(()=>He(!0)))}),[qe,Le]);var{billingAccountId:ze,cdeSession:We,paymentCountries:Ye,loadingCheckoutSession:$e}=ce(e),{vaultDomain:je,checkoutSessionId:Je}=We||{},{state:{email:{value:Xe},phoneNumber:{value:Ze},firstName:{value:Qe},lastName:{value:et}},validate:tt}=n(z),{cdeIframeForm:{submit:at,isValid:nt,highlightErrors:it},paymentFormFields:{cardholderName:{value:lt},street:{value:rt},street2:{value:ot},city:{value:st},state:{value:ut},country:{value:dt},postalCode:{value:ct}},paymentMethodInfo:{paymentDetails:{storedCardId:mt}},promoCodeForm:pt,updatePromoCodeForm:vt,validateFormFields:Ct}=n(L),{setDiscountCode:gt}=_(),[kt,ht]=i(!1);l((()=>{var e=le.discountCode||null;e&&gt(e);var t=m.get("discountCode");fe&&!kt&&t&&pt.appliedPromoCode!==t&&(ht(!0),vt({displayState:"ShowPromoCodes",isApplying:!0,promoCodeField:{...pt.promoCodeField,value:t}}))}),[le,gt,_e,he,pt,kt,ht,fe,vt]);var St=null;x.includes(null==Te?void 0:Te.discountCode)?St="Hertz":(null==Te?void 0:Te.discountCode)===U?St="Rent the Runway":(null==Te?void 0:Te.discountCode)===H&&(St="Audible");var bt,_t=f(Te||null,St),ft=!!(bt=Te)&&(bt.trialDiscount?bt.trialDiscountedPrice!==bt.originalPrice:bt.discountedPrice!==bt.originalPrice),Et=0===(null==De?void 0:De.totalAmount)&&0===(null==Te?void 0:Te.discountedPrice)&&(null==Te?void 0:Te.originalPrice)>0,yt=!!Ie,At=Et&&"EMPLOYEE_DISCOUNT"!==(null==Te?void 0:Te.discountType),Nt=mt||null,[Tt]=T(),[It]=I(),Dt=o((()=>Tt.filter((e=>e.valid&&!e.storedCardInfo.expired)).map((e=>e.storedCardInfo))),[Tt]),[Pt,Ft]=i(null),[Ot,Mt]=i(null),[Lt,wt]=i(!1),[Rt,Bt]=i(null),Vt=s((a=>{var n,i=yt?"STANDALONE_TRIAL":Se;n="paywall"===t?"restricted":"attractions"===t?"experiences":"standalone",Ce({itemType:"optimusCheckoutStep",itemId:"SubscriptionCheckout",itemName:a,team:"Plus",impressionKey:ue,pageUid:re,sessionId:se,userId:oe,page:ae,customData:JSON.stringify({checkoutType:e,flow:i,booking_flow:n})})}),[ae,oe,se,t,yt,Ce,ue,re,e]),xt=s(((t,a)=>{ke({itemType:"optimusCheckoutPurchaseError",itemName:t,impressionKey:ue,customData:{flow:Se,checkoutType:e,reasonType:a||"Unknown"}})}),[ue,ke,e]),Ut=s((()=>!yt||"00000"!==ct||(Ft("FIELD_COMBINATION_ERROR"),Bt(he.string("zip_code_not_allowed_for_trial")),we(!1),wt(!1),!1)),[yt,ct,Bt,we,wt,Ft,he]),Ht=s((()=>{if(At)return tt();var e=Ct(),t=tt(),a=Ut();return e&&t&&nt&&a}),[nt,Ct,tt,At,Ut]),Kt=s((()=>{if(we(!1),p.set("plus_confirm_px",!0),h)h();else{var e="";de(K(e+=A?`/Hotel_Review-d${A}?newPlusSubscriber=true&referringFunnelKey=${ue}`:St?`/OptimusSubscriptionConfirmation?oik=${ue}&partnerFlow=${St}`:`/OptimusSubscriptionConfirmation?oik=${ue}`))}}),[A,ue,de,h,St]),Gt=s((()=>{null!=Ue&&Ue.current&&Ue.current.scrollIntoView({behavior:"smooth",block:"start",inline:"start"})}),[Ue]),qt=s((e=>{we(!1),wt(!1),Ft(e||"MISSING_DATA"),k(Nt)}),[k,Nt]),zt=s((()=>{we(!1),wt(!1),Ft("INTERNAL_ERROR"),k(Nt)}),[k,Nt]),[Wt,Yt]=i(!1),[$t,jt]=i(!1),Jt=s((()=>{!Wt&&u("plus_hotel_checkout_save_pii")&&(Yt(!0),jt(!0))}),[Wt]),Xt=a.useCallback(((e,t)=>{jt(t)}),[]),Zt=s((e=>{var t,a=(null==Te?void 0:Te.discountCode)||null;if(t=null!=Te&&Te.trialDiscount&&Ie&&Ie.trialCharge?Ie.trialCharge.totalAmount:void 0===(null==De?void 0:De.totalAmount)?null:null==De?void 0:De.totalAmount,e){var{token:n,cardType:i}=e;Fe({billingAccountId:ze||"",source:"StandaloneCheckoutFlow",checkoutSessionId:Je||"",billingAddress:{cardholderName:lt,street:rt,street2:ot,country:dt,city:st,state:ut,postalCode:ct},firstName:Qe,lastName:et,emailAddress:Xe,phoneNumber:Ze,paymentToken:n,storedCardId:Nt,discountCode:a,onSuccess:Kt,onError:qt,cardType:i,inAuthTransactionId:Ke,updateMemberAccountInfo:$t,expectedSubscriptionPrice:t,csrfToken:Oe})}else Fe({billingAccountId:ze||"",source:"StandaloneCheckoutFlow",checkoutSessionId:Je||"",firstName:Qe,lastName:et,emailAddress:Xe,phoneNumber:Ze,paymentToken:null,cardType:"",storedCardId:null,discountCode:a,onSuccess:Kt,onError:qt,inAuthTransactionId:Ke,updateMemberAccountInfo:$t,expectedSubscriptionPrice:t,csrfToken:Oe})}),[Fe,ze,Je,lt,rt,ot,dt,st,ut,ct,Xe,Ze,Qe,et,Nt,null==Te?void 0:Te.discountCode,null==De?void 0:De.totalAmount,Kt,qt,Ke,$t,null==Te?void 0:Te.trialDiscount,Ie,Oe]),Qt=s((({token:e,cardType:t})=>{wt(!0),Zt({token:e,cardType:t})}),[Zt]),ea=s((()=>{if(xe(Ve+1),Ht&&at){Be(!0),Ft(null),Mt(null);var t=Ht();ge({pageUid:re,impressionKey:ue,actionType:"click",itemType:"checkoutCompleteClick",team:"Plus",actionSubType:"OptimusStandaloneCheckout",customData:JSON.stringify({isFormValid:t,isTrial:yt,checkoutType:e})}),At?t?(we(!0),wt(!0),Zt(null)):(we(!1),Gt()):(nt||xt("CDEPaymentFormInvalid","Partner"),t?(we(!0),at({name:lt,address:{street:rt,street2:ot,country:dt,city:st,state:ut,postalCode:ct}})):(we(!1),it(),Gt()))}}),[Ht,at,ge,ue,re,xt,lt,rt,ot,dt,st,ut,ct,nt,it,Gt,Ve,At,Zt,yt,e]),{selectedCard:ta,openStoredCardsModal:aa,showStoredCardsModal:na,closeStoredCardsModal:ia,updateSelectedCard:la}=w({storedCards:Dt});l((()=>{Pt&&Ue&&Gt()}),[Pt,Gt]);var ra=s((()=>Vt("CHECKOUT")),[Vt]);if(null!=Pe&&Pe.isMember&&"memberCenter"!==t)return a.createElement(me,{isModal:"PAGE"!==e});if(ye||$e)return a.createElement(pe,{isModal:"PAGE"!==e});if(null==De||!De.totalAmount&&!Et||!je||!Je||!Ye||!ze||Ae||Pt&&"PAYMENT_FAILURE"!==Pt&&"FIELD_COMBINATION_ERROR"!==Pt)return a.createElement(E,{flow:Se,errors:[{isRecoverable:!1,translationString:"",problemName:Pt||"MISSING_DATA",problemType:Ot||"Unknown",fieldName:null}],isModal:"PAGE"!==e});var oa=fe?null==Te?void 0:Te.originalPrice:De.totalAmount,sa=yt&&_t?[[{title:he.string("plus_checkout_trial_membership_item"),price:null==Ie||null==(O=Ie.trialCharge)?void 0:O.totalAmount,variant:"TRIAL"}],[{title:he.string("plus_checkout_total"),price:null==Ie||null==(M=Ie.trialCharge)?void 0:M.totalAmount,variant:"TOTAL"}]]:[[{title:he.string("plus_checkout_plus_membership_item"),price:oa,variant:"TOTAL"}]];!yt&&fe&&_t&&(sa[0].push({automationName:"discountCharge",onRemove:_t.onRemove,price:_t.price,subtitle:_t.subtitle,title:_t.title,tooltipBody:_t.tooltipBody,tooltipTitle:_t.tooltipTitle,variant:_t.variant}),sa.push([{title:he.string("plus_checkout_total"),price:De.totalAmount,variant:"TOTAL"}]));var ua,da=a.createElement(G,{initialFirstName:null==It?void 0:It.firstName,initialLastName:null==It?void 0:It.lastName,initialEmail:null==It?void 0:It.email,initialPhoneNumber:null==It||null==(q=It.phoneNumbers)||null==(J=q[0])?void 0:J.digits,checkoutType:"STANDALONE",onChangeCallback:Jt,isModal:"PAGE"!==e,freeTrialSubscription:P}),ca=Et?he.string("plus_checkout_charge_schedule_disclaimer_plus_free_and_hotel"):null,ma=a.createElement(a.Fragment,null,a.createElement(R,{vaultDomain:je,checkoutSessionId:Je,onSuccess:Qt,onError:zt,storedCard:ta,subHeading:ca,checkoutType:"STANDALONE",isModal:"PAGE"!==e,paymentAlert:Me}),"PAGE"!==e&&Dt.length?a.createElement(D,{display:"flex",flexDirection:"column",alignItems:"flex-start"},a.createElement(ne,{variant:"accent",onClick:aa},a.createElement(j,{id:"plus_checkout_change_payment_method_cta"}))):null),pa=a.createElement(B,{countries:Ye,checkoutType:"STANDALONE",withoutAddCheckbox:!0,onChangeCallback:Jt,isModal:"PAGE"!==e}),va=At?null:a.createElement(V,{storedCards:Dt,vaultDomain:je,checkoutSessionId:Je,onSuccess:Qt,onError:zt,countries:Ye,subHeading:ca,checkoutType:"STANDALONE",withoutAddCheckbox:!0,onChangeCallback:Jt,selectedCard:ta,openStoredCardsModal:aa,showStoredCardsModal:na,closeStoredCardsModal:ia,updateSelectedCard:la,paymentAlert:Me}),Ca=a.createElement("div",{"data-automation":"updateMemberAccountInfo"},a.createElement(g,{value:"updateMemberAccountInfo",disabled:!Wt,checked:$t,label:he.string("ib_update_account_info"),variant:"trail",onToggle:Xt}));return F({submitting:Le,showTransition:Lt,travelerDetailsForm:da,billingAndPaymentForm:va,billingForm:pa,paymentForm:ma,storedCard:ta,updateMemberAccountInfo:Ca,formErrors:(ua=Pt,"PAYMENT_FAILURE"===ua?a.createElement(c,{onIsVisibleCallback:()=>xt(ua,"Partner")},a.createElement(D,{marginBottom:"spacing-04"},a.createElement(C,{ref:Ue,variant:"danger",label:a.createElement(j,{id:"plus_checkout_inline_error_heading"})},a.createElement(j,{id:"plus_checkout_inline_error_subheading"})))):"FIELD_COMBINATION_ERROR"===ua?a.createElement(c,{onIsVisibleCallback:()=>xt(ua,"User")},a.createElement(D,{marginBottom:"spacing-04"},a.createElement(C,{ref:Ue,variant:"danger",label:a.createElement(j,{id:"plus_checkout_inline_error_heading"})},Rt))):a.createElement(y,{ref:Ue,showCdeValidationErrorMessages:Re&&!At,submissionAttempts:Ve,flow:Se})),charges:sa,trialDetails:Ie,partnerDiscountFlow:St,isDiscounted:ft,isFullyDiscounted:Et,isNoPaymentPurchase:At,totalSubscriptionAmount:De.totalAmount,onIsVisible:ra,onSubscriptionStartClick:ea,showStoredCardsModal:na,updateSelectedCard:la,storedCards:Dt,selectedCard:ta,paymentAlert:Me})},_e=({mode:e,modalVariant:t,hotelId:n,funnelKey:i,onPurchaseSuccess:l,onPurchaseError:r=(()=>{}),freeTrialSubscription:o,children:s})=>a.createElement(A,{funnelKey:i},a.createElement(M,null,a.createElement(q,null,a.createElement(F,{shouldLogoutAfterPaymentFailures:!0,renderBeforeLogout:()=>a.createElement(P,null)},(({failedCardPayment:i})=>{var d=e=>{i(e),r()};return a.createElement(O,{renderNotSecure:()=>a.createElement(P,null),skip:u("optimus_bypass_secure_login")},(()=>a.createElement(be,{mode:e,modalVariant:t,hotelId:n,onPaymentError:d,onPurchaseSuccess:l,freeTrialSubscription:o},s)))})))));return[()=>{(ue=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"StartCheckoutSessionMutation"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"request"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"OptimusBenefits_SubscriptionCheckoutSessionRequestInput"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"subscriptionCheckout"},"name":{"kind":"Name","value":"OptimusBenefits_startSubscriptionCheckout"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"request"},"value":{"kind":"Variable","name":{"kind":"Name","value":"request"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"billingAccountId"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"cdeSession"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"checkoutSessionId"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"vaultDomain"},"arguments":[],"directives":[]}]}},{"kind":"Field","name":{"kind":"Name","value":"countryStateData"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"availableCountries"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"countryName"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"isoCode"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"statesData"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"isoCode"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"stateName"},"arguments":[],"directives":[]}]}}]}}]}}]}}]}}],"loc":{"start":0,"end":468}}')).__key=0xd94736f63dd6,de=ue,ce=Ce,me=ge,ve=he,e({SubscriptionCheckoutLoading:pe=ke,SubscriptionCheckoutWrapper:_e})},[e=>(a=e.default,n=e.useContext,i=e.useState,l=e.useEffect,r=e.useRef,o=e.useMemo,s=e.useCallback),e=>u=e.featureIsEnabled,e=>d=e.useInAuth,e=>c=e.IsVisibleOnce,e=>m=e.default,e=>p=e.default,e=>v=e.uuid,e=>C=e.InlineAlert,e=>g=e.Checkbox,e=>(k=e.Device,h=e.TravelInfo,S=e.Route,b=e.Visitor),e=>(_=e.useDiscountCodePersistance,f=e.useDiscountCharge),e=>E=e.default,e=>y=e.default,e=>(A=e.FunnelTrackingProvider,N=e.FunnelTracking),e=>(T=e.useStoredCardsFlowState,I=e.useSensitiveFlowState),e=>D=e.Box,e=>P=e.default,e=>(F=e.OptimusHardGate,O=e.OptimusSecureLoginGate),e=>(M=e.PaymentProvider,L=e.Payment,w=e.useSelectedCard,R=e.PaymentDetailsForm,B=e.BillingAddressForm,V=e.BillingAndPaymentForm),e=>(x=e.HERTZ_DISCOUNTS,U=e.RTR_DISCOUNT,H=e.AUD_DISCOUNT),e=>K=e.needsRouting,e=>(G=e.default,q=e.TravelerDetailsProvider,z=e.TravelerDetails),e=>(W=e.useOptimusSubscriptionPrice,Y=e.useOptimusSubscription,$=e.usePurchaseOptimusSubscription),e=>(j=e.default,J=e.UnsafeLocalize,X=e.useIntlFormatter,Z=e.useLocalize),e=>Q=e.useImpressionV3Logger,e=>ee=e.useInteractionV3Logger,e=>te=e.useNavigate,e=>(ae=e.default,ne=e.BorderlessButton),e=>ie=e.OptimusImpression,e=>le=e.useMutation,e=>re=e.default,e=>oe=e.default,e=>se=e.LoadingSpinner]]},["cDcdfi","-i3PJS","Rkbqrj","BLrxBS","jaCyxS","qKFflQ","O-HcBE","AXLM-R","MsxLpS","2R4xv2","P89JOf","z3IoO6","9WVvjy","ETqDaL","rSObt2","SzaY02","a4qdZy","mT-Pb2","ENvJHX","7VHiHS","oPZBqR","uDwkMq","BWm3Dg","0DsHEV","30t50h","fsml46","1yEXVQ","7yGKf-","T2p98h","5X2em-","Kmjo-j","VP50Wc","V08PS7"]]);
