(this.$WP=this.$WP||[]).push(["rSObt2",(e,t)=>{"use strict";var r,n,o,l,a,i,s,u=["//","while(true);","while(1);","for(;;);"];function c(e,t,r){var o=r?`&${new URLSearchParams(r).toString()}`:"";return n("optimus_bypass_secure_login")&&(o=o.concat("&flowOrigin=optimus")),fetch(`/HotelBookingController?flowState=${e}${o}`,{method:"POST",body:JSON.stringify(t),credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((t=>{if(t.ok)return t.text();throw new Error(`Unable to fetch booking data for flow state: ${e}`)})).then((e=>(e=>{if("string"!=typeof e)throw new Error("Unable to parse JSON response");for(var t=0;t<u.length;t++){var r=u[t];if(0===e.indexOf(r))return JSON.parse(e.substring(r.length))}return JSON.parse(e)})(e))).catch((t=>{throw new Error(t||`Error while fetching data for flow state: ${e}`)}))}function d(e){c("BOOK",function(e){var t={...e,transactionId:r()};return["partnerInfos","paymentCountryConfig","phoneCountryConfig","billingInformation","metaOffers","hotelPhotos"].forEach((e=>delete t[e])),t}(e)).then((e=>console.debug("Booking submitted, res:",e)))}function f(){var{userId:e}=o(s),[t,n]=l([]),[i,u]=l(null),[d,f]=l(!0);return a((()=>{c("GET_CARDS",void 0,{requestId:r()}).then((e=>{n((e||[]).filter((e=>(e=>{var t,r,n=null==e||null==(t=e.storedCardInfo)||null==(r=t.billingAddressInfo)?void 0:r.addressInfo;return(null==n?void 0:n.country)&&(null==n?void 0:n.street)&&(null==n?void 0:n.city)&&(null==n?void 0:n.state)&&(null==n?void 0:n.postalCode)})(e)))),u(null)})).catch((e=>{u(e),n([])})).finally((()=>{f(!1)}))}),[e]),[t,i,d]}function h(e,t,n,i){var{userId:u}=o(s),[d,f]=l(null),[h,S]=l(null),[v,g]=l(!0);return a((()=>{c("START",{bookingSessionId:e,selectedRoomKey:t.key,selectedPartnerName:n.name,locationId:n.hotel.locationId,transactionId:r(),trackingContext:i}).then((e=>{f(e),S(null)})).catch((e=>{S(e),f(null)})).finally((()=>{g(!1)}))}),[e,t,n,i,u]),[d,h,v]}function S(){var{userId:e}=o(s),[t,r]=l(null),[n,i]=l(null),[u,d]=l(!0);return a((()=>{c("SENSITIVE").then((e=>{r(e),i(null)})).catch((e=>{i(e),r(null)})).finally((()=>{d(!1)}))}),[e]),[t,n,u]}var v=(e,t)=>{var{originalMetaPrice:r}=t;return i((()=>{var t,n,o=(null==e||null==(t=e[0])?void 0:t.rooms.some((e=>!!e.cashbackReward)))||!1,l=null==e||null==(n=e[0])?void 0:n.rooms.map((e=>{return t=e.displayPrice,parseInt(t.replace(/[^0-9]/g,""),10);var t}));return null!=l&&l.some((e=>((e,t,r)=>{if(r){var n=t-e;return n>=-10&&n<=3}return t===e})(r,e,o)))?"same":null!=l&&l.some((e=>e<r))?"lower":"higher"}),[e,r])};return e({attemptBooking:d,useSensitiveFlowState:S,useStartFlowState:h,useStoredCardsFlowState:f}),[()=>{e({attemptBooking:d,usePriceMismatchCheck:v,useSensitiveFlowState:S,useStartFlowState:h,useStoredCardsFlowState:f})},[e=>r=e.uuid,e=>n=e.featureIsEnabled,e=>(o=e.useContext,l=e.useState,a=e.useEffect,i=e.useMemo),e=>s=e.Visitor]]},["O-HcBE","-i3PJS","cDcdfi","2R4xv2"]]);
